# HomomorphicFiltering

同态滤波科研训练



# 处理步骤

## 一、读取图像

1. 通过 imread 函数读取原始图像

2. 设置滤波器参数

3. 通过 showImage 函数显示原始图像



## 二、转换为 YUV 颜色空间

**目的：分离出亮度通道，方便处理。**

1. 使用 cvtColor 函数将原始图像从 BGR 颜色空间转换为 YUV 颜色空间 

2. 使用 split 函数将单个 YUV 图像分离为 3 个单通道图像数组 yuv[3]，其中 yuv[0] 存储 Y 通道

   > YUV每个通道存储的内容：
   >
   > Y：亮度
   >
   > U 和 V ：色度。作用是描述影像色彩及饱和度，用于指定像素的颜色。



## 三、对 Y 通道进行同态滤波

### 1. 对数变换

创建一个与Y通道图像具有相同尺寸的 CV_64F 类型的空白图像 image_ln，并将之前的Y通道图像进行对数变换（+0.1 防止对数为 0），储存在空白图像中。



### 2. 傅里叶变换

将图像进行傅里叶变换，得到**实部和虚部**，存储在planes数组中；并将其**中心化**，使原点位于图像中心；**打印出频谱图**，观察中心化前后的不同频率的强度信息。(中心化之前，低频成分通常位于频谱图的中心，高频成分则位于频谱图的边缘)



### 3. 使用高斯同态滤波器进行滤波

<center><b>高斯同态滤波器公式：</b></center>

<center><font size="4">H(u,v) = (γH − γL) [1 − e<sup>-C[D<sup>2</sup>(u,v)/D<sub>0</sub><sup>2</sup>]</sup>] + γL</font></center>

<img src="http://pics.saikaisa.top/20230913120257.png"/>

**D0**：滤波半径

**D(u,v)**：点(x,y)到频谱图中心坐标的距离

**gammaL (γL)**：低频增益，取值在0和1之间

**gammaH (γH)**：高频增益，需要大于1

**C**：影响曲线中间的偏斜度

#### 滤波步骤：

(a)创建一个高斯同态滤波矩阵h，对矩阵中每个像素遍历进行滤波。

(b)将分离的实部和虚部分别与滤波矩阵h相乘。

(c)最后使用merge合并实部与虚部,得到高斯同态滤波结果。



## 四、后续处理

1. 进行傅里叶逆变换

2. 计算复数幅值，得到最终亮度信息

3. 进行归一化处理（防止后续指数变换时，数值过大溢出）

4. 进行指数变换

5. 进行归一化处理，使图片亮度在0~255范围内



## 五、通道合并和图像输出

1. 使用 merge 函数将处理后的 Y 通道与原 UV 通道合并。

2. 将图像从 YUV 颜色空间转换回 BGR 颜色空间

3. 显示处理后的图像
